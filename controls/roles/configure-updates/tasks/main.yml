---
- name: Configure unattended update
  ansible.builtin.cron:
    name: "stereum auto unattended update"
    minute: "{{ stereum.settings.updates.unattended.min | default('0') }}"
    hour: "{{ stereum.settings.updates.unattended.hour | default('3') }}" # default: 3:00 am
    day: "*/{{ stereum.settings.updates.unattended.interval_days | default(7) }}" # default: every 7 days
    job: >
      cd "{{ stereum.settings.controls_install_path | default('/opt/stereum') }}/ansible/controls"
      && ./unattended-update.sh
    state: "{{ 'present' if (stereum.settings.updates.unattended.install | default(false)) else 'absent' }}"
    user: "root"
  become: yes
# EOF
